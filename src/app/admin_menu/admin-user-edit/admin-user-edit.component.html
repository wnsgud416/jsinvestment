<div class="Admin_MenuPanel">

	<div class="Admin_MenuPanel_Title">
		<h3><mat-icon>manage_accounts</mat-icon> 유저 관리</h3>
	</div>

		<div class="Admin_User_Edit_SeachBox">
			<mat-form-field appearance="outline"  class="AdminUser_Edit_SearchFiled">
			  <mat-label>유저 검색</mat-label>
			  <mat-icon matPrefix>person</mat-icon>
			  <input matInput (keyup)="applyFilter($event)" placeholder="검색어" #input>
			  <button mat-icon-button matSuffix >
   				  <mat-icon>search</mat-icon>
   				</button>
			</mat-form-field>
			<mat-form-field appearance="outline" class="AdminUser_Edit_SubFiled">
			<mat-label>그룹 이동</mat-label>
			<mat-select [(value)]="selectedGroup">
			  <mat-option value="관리자" >관리자</mat-option>
			  <mat-option value="일반회원" >일반회원</mat-option>
			  <mat-option value="특별회원" >특별회원</mat-option>
			</mat-select>
		  </mat-form-field>
		  <button mat-stroked-button (click)="checkGroup()" class="NextBtn" matBadge="{{selection.selected.length}}" [matBadgeHidden]="selection.selected.length===0" matBadgePosition="after">적용</button>
		  <mat-form-field appearance="outline"  class="AdminUser_Edit_SubFiled">
			<mat-label>일괄 기능</mat-label>
			<mat-select [(value)]="quickActionValue">
			  <mat-option value="user_Delete">회원 삭제</mat-option>
			  <mat-option value="SubscriptionEnd">구독 종료</mat-option>
			</mat-select>
		  </mat-form-field>
		  <button mat-stroked-button (click)="quickAction()"  class="NextBtn" matBadge="{{selection.selected.length}}" [matBadgeHidden]="selection.selected.length===0" matBadgePosition="after">적용</button>
		  <mat-form-field appearance="outline"  class="AdminUser_Edit_SubFiled">
			  <mat-label>구독 연장</mat-label>
			  <input matInput [matDatepicker]="picker" [(ngModel)]="checkSubscriptionValue">
			  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
			  <mat-datepicker touchUi #picker></mat-datepicker>
		  </mat-form-field>
		  <button mat-stroked-button (click)="checkSubscription()"  class="NextBtn" matBadge="{{selection.selected.length}}" [matBadgeHidden]="selection.selected.length===0" matBadgePosition="after">적용</button>
		</div>

	<div class="Admin_User_EditBox">

	<table mat-table [dataSource]="tableRowData" *ngIf="tableRowData">

	   <ng-container matColumnDef="select" sticky>
    <th mat-header-cell *matHeaderCellDef class="Table_AllCheckBox" style="text-align: center;">
      <mat-checkbox (change)="$event ? masterToggle() : null"
                    [checked]="selection.hasValue() && isAllSelected()"
                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                    [aria-label]="checkboxLabel()">
      </mat-checkbox>
    </th>
    <td mat-cell *matCellDef="let row" class="Table_CheckBox" style="text-align: center;">
      <mat-checkbox (click)="$event.stopPropagation()"
                    (change)="$event ? selection.toggle(row) : null"
                    [checked]="selection.isSelected(row)"
                    [aria-label]="checkboxLabel(row)">
      </mat-checkbox>
    </td>
  </ng-container>

	  <ng-container matColumnDef="email" sticky>
		<th mat-header-cell *matHeaderCellDef style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> 아이디 </th>
		<td mat-cell *matCellDef="let element" style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> {{element.email}} </td>
	  </ng-container>

	  <ng-container matColumnDef="name">
		<th mat-header-cell *matHeaderCellDef style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> 이름 </th>
		<td mat-cell *matCellDef="let element" style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> {{element.name}} </td>
	  </ng-container>


	  <ng-container matColumnDef="phone">
		<th mat-header-cell *matHeaderCellDef style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> 전화번호 </th>
		<td mat-cell *matCellDef="let element" style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> {{element.phone}} </td>
	  </ng-container>


	  <ng-container matColumnDef="group">
		<th mat-header-cell *matHeaderCellDef style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> 그룹 </th>
		<td mat-cell *matCellDef="let element" style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> {{element.group}} </td>
	  </ng-container>

	  <ng-container matColumnDef="created_at">
		<th mat-header-cell *matHeaderCellDef style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> 가입일 </th>
		<td mat-cell *matCellDef="let element" style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> {{element.created_at}} </td>
	  </ng-container>

	  <ng-container matColumnDef="updated_at">
		<th mat-header-cell *matHeaderCellDef style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> 구독 종료일 </th>
		<td mat-cell *matCellDef="let element" style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;" class="Subscription_Filed">
		<mat-form-field appearance="outline">
		<input matInput [matDatepicker]="Subscriptionpicker" value="{{element.updated_at}}" (dateInput)="subscription($event.value,element.id)" readonly>
		<mat-datepicker touchUi #Subscriptionpicker ></mat-datepicker>
		</mat-form-field>
		<!-- <button mat-stroked-button (click)="Subscriptionpicker.open($event.stopPropagation())" class="NextBtn">구독 연장</button> -->
    <button mat-stroked-button (click)="Subscriptionpicker.open()" (click)="$event.stopPropagation()" class="NextBtn">구독 연장</button>
		</td>
	  </ng-container>

	  <ng-container matColumnDef="action" sticky>
		<th mat-header-cell *matHeaderCellDef style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;"> 기능 </th>
		<td mat-cell *matCellDef="let element" style="width: calc(16.66vw - 50px); text-align: center; padding: 0 2vw;">

		<button mat-stroked-button (click)="groupClick($event.stopPropagation(),element.id)" [matMenuTriggerFor]="Admin_Group_ListMenu">그룹 이동</button>
		<button mat-stroked-button (click)="User_Edit(element.name,$event.stopPropagation(),element.phone,element.id,element.email)"  class="AddBtn">회원 수정</button>
		<button mat-stroked-button (click)="User_Remove(element.name,$event.stopPropagation(),element.phone,element.id,element.email)" class="RedBtn">회원 삭제</button>


		</td>
	  </ng-container>

	  <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
	  <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selection.toggle(row)"></tr>


	  <tr class="Search_resulttext" *matNoDataRow>
				<td class="mat-cell" colspan="8">
				<mat-icon>search_off</mat-icon>
				<p>"{{input.value}}"에 대한 검색결과가 없습니다.</p>
				</td>
	</tr>
	</table>

	</div>
</div>


<mat-menu #Admin_Group_ListMenu="matMenu">
  <button mat-menu-item (click)="groupMove('관리자')">
    <span>관리자</span>
  </button>
  <button mat-menu-item (click)="groupMove('일반회원')">
    <span>일반회원</span>
  </button>
  <button mat-menu-item (click)="groupMove('특별회원')">
    <span>특별회원</span>
  </button>
</mat-menu>
